{% load static %}
{% load echoes %}
<link href="https://fonts.googleapis.com/css?family=Rokkitt" rel="stylesheet">
<!--Modal: Login with Avatar Form-->
<div class="modal fade" id="modalLoginAvatar" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"
  aria-hidden="true">
  <div class="modal-dialog cascading-modal modal-avatar modal-lg" role="document">
    <!--Content-->
    <div class="modal-content">
      <div class="modal-header pb-0">
        <img src="{{ request.user.profile.image.url }}" height="130" width="130" alt="avatar" class="rounded-circle">
      </div>
      <div class="modal-body mb-1">
        <div class="md-form mb-0 ml-0 mr-0">
          <div id="echo_post_inp"  contenteditable data-placeholder="add something here..." class="form-control form-control-sm ml-0 mt-0"></div>
        </div>
        <div id="modal-echo-body">

        </div>
        <div class="text-center mt-4">
          <button id="echo-submit-btn" class="btn btn-cyan mt-1"
          ><img src="{% static 'icons/echo_48.png' %}" height="27.5" width="27.5" alt=""> Echo</button>
        </div>
      </div>
    </div>
  </div>
</div> 
{% for content in contents %}
    <section class="hero" id="card">
        <div class="container">
        <div class="row">
            <div class="col-12">
            <div class="cardbox shadow-lg bg-white">
            <div class="cardbox-heading">
            <!-- START dropdown-->
            <div class="dropdown float-right">
                <button class="btn btn-flat btn-flat-icon" type="button" data-toggle="dropdown" aria-expanded="false">
                <em class="fa fa-ellipsis-h"></em>
                </button>
                <div class="dropdown-menu dropdown-scale dropdown-menu-right" role="menu" style="position: absolute; transform: translate3d(-136px, 28px, 0px); top: 0px; left: 0px; will-change: transform;">
                <a class="dropdown-item" href="#">Hide post</a>
                <a class="dropdown-item" href="#">Stop following</a>
                <a class="dropdown-item" href="#">Report</a>
                </div>
            </div><!--/ dropdown -->
            <div class="media m-0">
                <div class="d-flex mr-3">
                <a href="{% url 'profile' content.author.id %}"><img class="img-fluid rounded-circle" src="{{ content.author.profile.image.url }}" alt="User"></a>
                </div>
                <div class="media-body">
                <p class="m-0"><a style="color:#5DA1D9"
                     href="{% url 'profile' content.author.id %}">
                     {{ content.author.first_name }} {{ content.author.last_name }}
                    </a>
                </p>
                <small><span><i class="icon ion-md-pin"></i> {{ content.author.profile.country }}, {{ content.author.profile.state }}</span></small>
                <small><span><i class="icon ion-md-time"></i> {{ content.posted  | timesince }} ago</span></small>
                </div>
            </div><!--/ media -->
            </div><!--/ cardbox-heading -->
            
            <div class="cardbox-item">
                {% if content.image_content %}
                <img class="img-fluid" src="{{content.image_content.url}}" alt="Image">
                <div class="mt-1 mb-1" style="border-bottom: 2px solid #f4f4f4;"></div>
                {% endif %}
                <p class="cardbox-item-p" style="margin:0 auto; width:80%; overflow-wrap: break-word;">{{ content.content }}</p>
                {% if content.is_echo %}
                <div class="cardbox mr-3 cardbox-echo bg-white mt-1">
                    <span class="echoed mt-3 mr-3"><img height="30" width="30" src="{% static 'icons/echo_48.png' %}" alt=""></span>
                    <div class="cardbox-heading">
                        <div class="media m-0">
                            <div class="d-flex mr-3">
                                <a href="{% url 'profile' content.parent.author.id %}"><img class="img-fluid rounded-circle" src="{{ content.author.profile.image.url }}" alt="User"></a>
                            </div>
                            <div class="media-body">
                                <p class="m-0"><a style="color:#5DA1D9"
                                    href="{% url 'profile' content.author.id %}">
                                    {{ content.parent.author.first_name }} {{ content.parent.author.last_name }}
                                    </a>
                                </p>
                                <small><span><i class="icon ion-md-pin"></i> {{ content.parent.author.profile.country }}, {{ content.parent.author.profile.state }}</span></small>
                                <small><span><i class="icon ion-md-time"></i> {{ content.parent.posted  | timesince }} ago</span></small>
                            </div>
                        </div><!--/ media -->
                    </div><!--/ cardbox-heading -->
                    <div class="cardbox-item">
                        {% if content.parent.image_content %}
                        <img class="img-fluid echo-img-fluid" src="{{content.parent.image_content.url}}" alt="Image">
                        <div class="mt-1 mb-1" style="border-bottom: 2px solid #f4f4f4;"></div>
                        {% endif %}
                        <p style="margin:0 auto; width:80%; overflow-wrap: break-word;">{{ content.parent.content }}</p>
                    </div>
                </div>
                {% endif %}
            </div><!--/ cardbox-item -->
            <div class="cardbox-base">
            <ul class="float-right">
                <li><a href="{% url 'comment' content.id %}"><i class="fa fa-comments"></i></a></li>
                <li><a><em class="mr-3">{{contents.comments|length}}</em></a></li>
                <li><a href="#"><img src="http://www.themashabrand.com/templates/bootsnipp/post/assets/img/users/3.jpeg" class="img-fluid rounded-circle" alt="User"></a></li>
                <li><a href="#"><img src="http://www.themashabrand.com/templates/bootsnipp/post/assets/img/users/1.jpg" class="img-fluid rounded-circle" alt="User"></a></li>
                <li><a href="#"><img src="http://www.themashabrand.com/templates/bootsnipp/post/assets/img/users/5.jpg" class="img-fluid rounded-circle" alt="User"></a></li>
                <li>
                    <a href="" data-toggle="modal" data-target="#modalLoginAvatar">
                        <i class="ml-4">
                        <img height="19" width="19" src="{% static 'icons/echo_48.png' %}" alt="">
                        </i>
                    </a>
                </li>
                <li><a><em class="mr-3">{{ content|post_echoes }}</em></a></li>
            </ul>
            <ul>
                <li class="reaction-like" data-postId="{{ content.id }}">
                    {% if request.user in content.likes.all %}
                    <i class="fa fa-thumbs-up" style="color:#5DA1D9; cursor: pointer;" data-react="unlike" data-action="like"></i>
                    {% else %}
                    <i class="fa fa-thumbs-up thumbs-up-react" style="cursor: pointer;" data-react="like" data-action="like"></i>
                    {% endif %}
                    <ins class="post_love_count thumbs-up-react" style="text-decoration:none; position: relative;top: -6px;left:-10px;font-size: 12.3px;">{{content.loves.count}}</ins>
                </li>
                <li class="reaction-like" data-postId="{{ content.id }}" style="margin-left: 3.5px !important;cursor:pointer;">
                    {% if request.user in content.loves.all %}
                        <img height="19"  data-react="love" data-action="unlike" width="19"
                        class="heart-gif" src="{% static 'heart_40.png' %}" />
                    {% else %}
                        <img height="19" data-react="love" data-action="like" width="19" 
                        class="heart-gif" src="{% static 'download.png' %}" />
                    {% endif %}
                    <ins class="post_likes_count" style="text-decoration:none; position: relative;top: -6px;left:4px;font-size: 12.3px;">{{content.likes.count}}</ins>
                </li>
                <!-- <li><a><span class="post_likes_count">{{content.likes.count}} Likes</span></a></li> -->
            </ul>			   
            </div><!--/ cardbox-base -->
            <div class="cardbox-comments">
            <span class="comment-avatar float-left">
                <a href=""><img class="rounded-circle" src="{{ request.user.profile.image.url }}" alt="..."></a>                            
            </span>
            <div class="search">
                <input placeholder="Write a comment" type="text">
                <button><i class="fa fa-camera"></i></button>
            </div><!--/. Search -->
            </div><!--/ cardbox-like -->			  
                    
            </div><!--/ cardbox -->

            </div><!--/ col-lg-6 -->	
        </div>
    </div>
</section>


{% endfor %}
{% block js %}
<script src="{% static 'js/libgif.js' %}"></script>
<script src="{% static 'js/content.js' %}"></script>
{% endblock js %}